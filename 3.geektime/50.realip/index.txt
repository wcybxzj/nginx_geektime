环境:
nginx :192.168.93.128
curl1 :192.168.93.128
================================================================================================
实验1:
nginx.conf:
set_real_ip_from 192.168.93.128;//不设置这个,意思是不允许请求修改$remote_addr
real_ip_recursive off;//意思是$remote_addr只获取X-Forwarded-For最后的ip

curl1 :192.168.93.128
curl -H 'X-Forwarded-For: 1.1.1.1,192.168.93.128' realip.taohui.tech:8080
Client real ip: 192.168.93.128

================================================================================================
实验2:
set_real_ip_from 192.168.93.128;//意思是只允许这个ip的请求修改$remote_addr
real_ip_recursive on;//意思是$remote_addr只获取X-Forwarded-For最前面的ip

curl1 :192.168.93.128
curl -H 'X-Forwarded-For: 1.1.1.1,192.168.93.128' realip.taohui.tech:8080
Client real ip: 1.1.1.1

